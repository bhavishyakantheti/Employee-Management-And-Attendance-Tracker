SQL> SELECT emp_id, COUNT(*) AS present_days
  2  FROM attendance
  3  WHERE status = 'Present'
  4  GROUP BY emp_id;

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
         1            7                                                         
       167            5                                                         
       153            5                                                         
       179            6                                                         
        30            6                                                         
        51            5                                                         
        91            5                                                         
       100            7                                                         
       129            2                                                         
       198            6                                                         
        22            6                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        25            4                                                         
        57            5                                                         
        78            4                                                         
        83            6                                                         
        87            2                                                         
        34            6                                                         
        42            3                                                         
        43            7                                                         
        54            4                                                         
       244            7                                                         
       245            4                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       247            1                                                         
       123            5                                                         
       138            2                                                         
       151            4                                                         
       152            4                                                         
       168            5                                                         
       173            4                                                         
       180            6                                                         
       227            6                                                         
       207            5                                                         
       218            6                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        29            4                                                         
        76            7                                                         
       222            6                                                         
        13            7                                                         
       144            4                                                         
       128            6                                                         
       213            7                                                         
         6            4                                                         
        11            6                                                         
        59            3                                                         
        77            7                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       113            4                                                         
       116            3                                                         
        28            6                                                         
        44            3                                                         
        47            6                                                         
       120            5                                                         
       121            4                                                         
       134            5                                                         
       147            6                                                         
       155            5                                                         
       157            4                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       189            3                                                         
       194            5                                                         
       209            3                                                         
       217            5                                                         
       235            4                                                         
       148            8                                                         
       149            5                                                         
       211            8                                                         
       108            6                                                         
        20            4                                                         
        86            5                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       112            5                                                         
        26            4                                                         
         2            6                                                         
        14            4                                                         
        21            4                                                         
        66            4                                                         
        70            2                                                         
        72            3                                                         
        84            4                                                         
        88            3                                                         
        90            6                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        95            2                                                         
        31            4                                                         
       249            4                                                         
       250            4                                                         
       132            5                                                         
       141            5                                                         
       177            6                                                         
       181            7                                                         
       185            3                                                         
       205            4                                                         
       210            6                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       220            3                                                         
       223            5                                                         
       224            4                                                         
       229            5                                                         
       163            9                                                         
        53            6                                                         
        85            3                                                         
        46            8                                                         
       240            7                                                         
       184            5                                                         
       201            9                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       230            6                                                         
         4            5                                                         
       164            7                                                         
        68            3                                                         
         5            4                                                         
        24            3                                                         
        81            6                                                         
        94            5                                                         
        96            3                                                         
       102            3                                                         
       117            5                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        32            5                                                         
       119            5                                                         
       133            3                                                         
       137            5                                                         
       143            4                                                         
       161            5                                                         
       162            5                                                         
       183            6                                                         
       191            4                                                         
       193            3                                                         
       215            5                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       135            8                                                         
       212            6                                                         
        63            3                                                         
        48            5                                                         
       125            4                                                         
       175            6                                                         
       206            5                                                         
         8            5                                                         
        17            5                                                         
        23            5                                                         
        61            6                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        69            2                                                         
        74            2                                                         
        75            5                                                         
       110            4                                                         
        35            2                                                         
        37            5                                                         
        38            6                                                         
        55            2                                                         
       239            4                                                         
       242            7                                                         
       246            5                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       248            2                                                         
       226            6                                                         
       231            6                                                         
       232            5                                                         
        50            6                                                         
       131            6                                                         
       165            8                                                         
        93            6                                                         
       178            5                                                         
       101            6                                                         
        56            4                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        71            2                                                         
        80            2                                                         
        99            6                                                         
       107            3                                                         
       114            5                                                         
        33            3                                                         
        40            4                                                         
        41            4                                                         
        45            6                                                         
        52            5                                                         
       238            5                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       241            4                                                         
       243            4                                                         
       130            4                                                         
       136            5                                                         
       140            5                                                         
       188            4                                                         
       199            6                                                         
       200            7                                                         
       214            7                                                         
       228            3                                                         
       233            5                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        27            4                                                         
       221            6                                                         
       154            5                                                         
       115            5                                                         
       182            8                                                         
       124            3                                                         
         7            5                                                         
        97            6                                                         
        58            6                                                         
       196            6                                                         
       104            5                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
         3            4                                                         
        18            4                                                         
        64            4                                                         
        89            5                                                         
       105            4                                                         
       109            2                                                         
        36            6                                                         
        49            6                                                         
       142            5                                                         
       145            2                                                         
       146            4                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       158            3                                                         
       169            6                                                         
       171            6                                                         
       172            3                                                         
       176            5                                                         
       186            6                                                         
       190            4                                                         
       192            5                                                         
       195            4                                                         
       202            4                                                         
       203            7                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       216            5                                                         
       225            4                                                         
       236            2                                                         
       160            5                                                         
        39            8                                                         
        12            4                                                         
       166            5                                                         
       156            8                                                         
       187            5                                                         
         9            6                                                         
        10            4                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        15            6                                                         
        16            5                                                         
        19            7                                                         
        60            6                                                         
        62            6                                                         
        65            3                                                         
        67            5                                                         
        73            2                                                         
        79            3                                                         
        82            5                                                         
        92            5                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
        98            6                                                         
       103            2                                                         
       106            1                                                         
       111            1                                                         
       118            2                                                         
       237            4                                                         
       122            5                                                         
       126            4                                                         
       127            6                                                         
       139            6                                                         
       150            6                                                         

    EMP_ID PRESENT_DAYS                                                         
---------- ------------                                                         
       159            3                                                         
       170            5                                                         
       174            2                                                         
       197            5                                                         
       204            4                                                         
       208            6                                                         
       219            4                                                         
       234            4                                                         

250 rows selected.

SQL> SELECT emp_id, COUNT(*) AS absents
  2  FROM attendance
  3  WHERE status = 'Absent'
  4  GROUP BY emp_id
  5  HAVING COUNT(*) > 5;

no rows selected

SQL> SELECT emp_id, COUNT(*) AS absents
  2  FROM attendance
  3  WHERE status = 'Absent'
  4  GROUP BY emp_id
  5  HAVING COUNT(*) > 3;

    EMP_ID    ABSENTS                                                           
---------- ----------                                                           
       138          4                                                           
       129          4                                                           
        74          4                                                           
        33          4                                                           

SQL> SELECT emp_id, SUM((check_out - check_in) * 24) AS total_hours
  2  FROM attendance
  3  GROUP BY emp_id
  4  HAVING SUM((check_out - check_in) * 24) > 40;

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       152  95.8133333                                                          
         1  83.8772222                                                          
       167  93.2647222                                                          
       153  71.8663889                                                          
       179  89.3194444                                                          
        30  70.7302778                                                          
        51  81.4461111                                                          
       198     90.3275                                                          
        25  112.776389                                                          
       180  84.5741667                                                          
        42  58.8333333                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       244  84.6788889                                                          
       123      87.445                                                          
        87  75.5327778                                                          
        34  85.2880556                                                          
        22  80.5952778                                                          
        91  73.9613889                                                          
       100  68.8927778                                                          
       138  68.6130556                                                          
       129  64.8063889                                                          
        54  71.8080556                                                          
        57  59.4405556                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
        83  68.1627778                                                          
        78  57.8811111                                                          
        43  71.9977778                                                          
       245  76.7477778                                                          
       247  76.1672222                                                          
       151  78.4563889                                                          
       168  48.4072222                                                          
       173  74.1441667                                                          
       227  79.8472222                                                          
       189  74.6436111                                                          
       207  81.0138889                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       213  87.9322222                                                          
        29  106.827778                                                          
       128  72.0777778                                                          
         6  85.4347222                                                          
       235  92.2061111                                                          
       218  73.3747222                                                          
        76  63.6766667                                                          
       217  83.4383333                                                          
        59  83.5908333                                                          
       222  80.7036111                                                          
        13  88.8013889                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       144  73.2547222                                                          
       116  77.1427778                                                          
       134  77.5286111                                                          
        11  73.2280556                                                          
        77  71.7086111                                                          
       113  52.4911111                                                          
        28      71.165                                                          
        44  65.6147222                                                          
        47     69.3225                                                          
       120  75.2577778                                                          
       121  59.6683333                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       147  64.4597222                                                          
       155  82.9266667                                                          
       157  77.0038889                                                          
       194  70.9447222                                                          
       209  51.9377778                                                          
       229  100.124722                                                          
       224     93.5125                                                          
        95  62.9402778                                                          
       148       86.96                                                          
       149     76.1475                                                          
        86  68.9447222                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
        66  67.4136111                                                          
       223  90.2563889                                                          
       210  95.5919444                                                          
       211  101.419722                                                          
       112  68.2388889                                                          
       108  67.8622222                                                          
        20  71.6913889                                                          
        26  93.7719444                                                          
        31  74.8477778                                                          
        88  73.6913889                                                          
         2  62.3433333                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
        14  77.5644444                                                          
        21  47.7683333                                                          
        70  57.6483333                                                          
        72  59.7219444                                                          
        84     74.3875                                                          
        90  67.7516667                                                          
       249  72.4113889                                                          
       132  69.6536111                                                          
       141  61.1877778                                                          
       177  70.6366667                                                          
       181  68.0236111                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       185  72.0191667                                                          
       205  72.7533333                                                          
       220  71.9852778                                                          
       183  81.9077778                                                          
       163  95.7730556                                                          
       201  127.407222                                                          
        46  90.9472222                                                          
        53  95.7261111                                                          
        85  52.1188889                                                          
       215  74.2291667                                                          
       240  71.7419444                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
        32     69.3375                                                          
       184  81.4513889                                                          
       119  90.4902778                                                          
         4  84.9511111                                                          
        94  83.8422222                                                          
       230  90.2730556                                                          
       191  74.1183333                                                          
       164  87.6705556                                                          
        68  93.1033333                                                          
       162  79.8930556                                                          
       193     60.0475                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
         5  67.8227778                                                          
        24  51.3130556                                                          
        81  53.0233333                                                          
        96  66.2808333                                                          
       102  57.6102778                                                          
       117      73.405                                                          
       133  63.4322222                                                          
       137  51.5061111                                                          
       143  71.6752778                                                          
       161  60.3805556                                                          
       232      73.465                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       135  102.845556                                                          
       248  79.7933333                                                          
       212  80.7486111                                                          
        63  52.4277778                                                          
         8  82.7013889                                                          
       175  98.6802778                                                          
        48  82.2322222                                                          
       231  75.0205556                                                          
       125  49.5580556                                                          
        17  93.0619444                                                          
       239  82.9705556                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
        23  66.3022222                                                          
        75  70.8105556                                                          
       246  60.2808333                                                          
        55  63.7052778                                                          
       206  81.4277778                                                          
        61  81.2063889                                                          
        69  54.7702778                                                          
       110  61.2138889                                                          
        35  75.4713889                                                          
        37  67.0436111                                                          
        38  70.1652778                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       242  80.8577778                                                          
       226  71.8188889                                                          
        33  82.9938889                                                          
        50     77.4075                                                          
       101  97.1144444                                                          
        80  77.2080556                                                          
        99  84.1802778                                                          
       131  92.7536111                                                          
       165  89.1266667                                                          
        93  80.5188889                                                          
        41  89.5041667                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       238  93.8919444                                                          
       178  74.6713889                                                          
        45  77.2141667                                                          
       130      84.375                                                          
       136  83.4238889                                                          
       200  80.8344444                                                          
       188  83.9411111                                                          
       233  76.8008333                                                          
        56  74.5072222                                                          
        71  54.2419444                                                          
       107  75.9630556                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       114  61.5680556                                                          
        40  61.4502778                                                          
        52  77.0158333                                                          
       241  67.3944444                                                          
       243  67.8930556                                                          
       140     73.0475                                                          
       199     72.2625                                                          
       214  70.7955556                                                          
       228  70.7480556                                                          
        27  71.4952778                                                          
        49  83.3627778                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       104  116.226389                                                          
       196     83.2825                                                          
       169  84.1155556                                                          
       221  93.1033333                                                          
         3  95.6747222                                                          
       190  80.9477778                                                          
       154  83.4716667                                                          
        18    108.3525                                                          
       124  72.3869444                                                          
       115  85.0922222                                                          
       195  74.9972222                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       172  67.9591667                                                          
        36  87.1672222                                                          
       182  92.7572222                                                          
         7  73.0372222                                                          
        97  81.8313889                                                          
       225  69.2038889                                                          
       171  69.6611111                                                          
        58  86.8941667                                                          
       192  84.8580556                                                          
       236     57.4325                                                          
       158  63.1163889                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
        64  66.3627778                                                          
        89       61.37                                                          
       105  76.7933333                                                          
       109  85.4694444                                                          
       142  73.5330556                                                          
       145  57.4102778                                                          
       146  73.7372222                                                          
       176  71.7663889                                                          
       186  75.3847222                                                          
       202  49.3619444                                                          
       203  76.5033333                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       216     64.1625                                                          
       166  87.6136111                                                          
       150  81.4588889                                                          
       160  82.8816667                                                          
        98       84.05                                                          
       126  94.8780556                                                          
       159  79.7380556                                                          
        39  90.1380556                                                          
       219  70.4044444                                                          
        19  93.0841667                                                          
       237  94.8677778                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       122  74.9941667                                                          
        60  76.8936111                                                          
        12  64.2052778                                                          
       139  97.4394444                                                          
       156  84.6452778                                                          
       187  86.4961111                                                          
        82  75.1311111                                                          
         9  74.4497222                                                          
        73  49.3797222                                                          
        92  81.4613889                                                          
       174  60.2341667                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       103      49.235                                                          
        10  77.2755556                                                          
        15  71.4994444                                                          
        16  70.6177778                                                          
        62  67.7169444                                                          
        65  82.5638889                                                          
        67  74.8266667                                                          
        79  56.0041667                                                          
       106  75.5152778                                                          
       111  56.7138889                                                          
       118     67.1375                                                          

    EMP_ID TOTAL_HOURS                                                          
---------- -----------                                                          
       127  80.1411111                                                          
       170  59.1897222                                                          
       197  61.3577778                                                          
       204  64.6066667                                                          
       208  74.9072222                                                          
       234  61.0638889                                                          

248 rows selected.

SQL> SELECT emp_id, COUNT(*) AS late_days
  2  FROM attendance
  3  WHERE status = 'Late' AND TO_CHAR(check_in, 'MM-YYYY') = '07-2025'
  4  GROUP BY emp_id
  5  HAVING COUNT(*) > 3;

    EMP_ID  LATE_DAYS                                                           
---------- ----------                                                           
        25          4                                                           
        87          4                                                           
       247          6                                                           
       189          4                                                           
        29          5                                                           
       116          4                                                           
        59          4                                                           
       229          4                                                           
       224          4                                                           
       223          4                                                           
        26          5                                                           

    EMP_ID  LATE_DAYS                                                           
---------- ----------                                                           
       185          4                                                           
       220          4                                                           
         4          4                                                           
        68          6                                                           
       248          6                                                           
       239          4                                                           
        55          4                                                           
        35          5                                                           
       101          4                                                           
        80          5                                                           
        41          4                                                           

    EMP_ID  LATE_DAYS                                                           
---------- ----------                                                           
       107          4                                                           
       228          4                                                           
         3          4                                                           
       124          4                                                           
       172          4                                                           
        18          4                                                           
       109          5                                                           
       159          5                                                           
       237          4                                                           
        65          4                                                           
       106          6                                                           

    EMP_ID  LATE_DAYS                                                           
---------- ----------                                                           
       111          4                                                           
       118          4                                                           

35 rows selected.

SQL> SELECT dept_id, COUNT(*) AS total_employees
  2  FROM employees
  3  GROUP BY dept_id;

   DEPT_ID TOTAL_EMPLOYEES                                                      
---------- ---------------                                                      
         1              53                                                      
         2              48                                                      
         4              52                                                      
         5              47                                                      
         3              50                                                      

SQL> SELECT dept_id, COUNT(*) AS total
  2  FROM employees
  3  GROUP BY dept_id
  4  HAVING COUNT(*) > 10;

   DEPT_ID      TOTAL                                                           
---------- ----------                                                           
         1         53                                                           
         2         48                                                           
         4         52                                                           
         5         47                                                           
         3         50                                                           

SQL> SELECT e.dept_id, COUNT(*) AS attendance_count
  2  FROM employees e
  3  JOIN attendance a ON e.emp_id = a.emp_id
  4  GROUP BY e.dept_id
  5  HAVING COUNT(*) > 15;

   DEPT_ID ATTENDANCE_COUNT                                                     
---------- ----------------                                                     
         1              431                                                     
         2              377                                                     
         5              380                                                     
         4              407                                                     
         3              405                                                     

SQL> SELECT e.dept_id, ROUND(AVG((a.check_out - a.check_in) * 24), 2) AS avg_hours
  2  FROM employees e
  3  JOIN attendance a ON e.emp_id = a.emp_id
  4  GROUP BY e.dept_id
  5  HAVING AVG((a.check_out - a.check_in) * 24) > 7;

   DEPT_ID  AVG_HOURS                                                           
---------- ----------                                                           
         1      10.31                                                           
         2      10.41                                                           
         5      10.34                                                           
         4      10.34                                                           
         3      10.38                                                           


SQL> SELECT role_id, COUNT(*) AS total
  2  FROM employees
  3  GROUP BY role_id;

   ROLE_ID      TOTAL                                                           
---------- ----------                                                           
         1         57                                                           
         2         50                                                           
         4         47                                                           
         5         47                                                           
         3         49                                                           

SQL> SELECT e.role_id, ROUND(AVG((a.check_out - a.check_in) * 24), 2) AS avg_hours
  2  FROM employees e
  3  JOIN attendance a ON e.emp_id = a.emp_id
  4  GROUP BY e.role_id
  5  HAVING AVG((a.check_out - a.check_in) * 24) > 8;

   ROLE_ID  AVG_HOURS                                                           
---------- ----------                                                           
         1      10.44                                                           
         2      10.39                                                           
         5      10.25                                                           
         4      10.32                                                           
         3      10.34                                                           

SQL> SELECT TRUNC(check_in) AS late_day, COUNT(*) AS late_count
  2  FROM attendance
  3  WHERE status = 'Late'
  4  GROUP BY TRUNC(check_in)
  5  HAVING COUNT(*) > 2;

LATE_DAY  LATE_COUNT                                                            
--------- ----------                                                            
18-JUL-25         56                                                            
17-JUL-25         68                                                            
20-JUL-25         67                                                            
21-JUL-25        153                                                            
16-JUL-25         72                                                            
15-JUL-25         68                                                            
19-JUL-25         60                                                            

7 rows selected.                                                                

SQL> SELECT TO_CHAR(check_in, 'Day') AS weekday, COUNT(*) AS total_records
  2  FROM attendance
  3  GROUP BY TO_CHAR(check_in, 'Day')
  4  HAVING COUNT(*) > 20;

WEEKDAY   TOTAL_RECORDS                                                         
--------- -------------                                                         
Sunday              229                                                         
                    175                                                         
Monday              475                                                         
Thursday            230                                                         
Friday              225                                                         
Wednesday           221                                                         
Tuesday             230                                                         
Saturday            215                                                         

8 rows selected.

SQL> spool off
